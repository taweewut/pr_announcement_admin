<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PR Announcement Management</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-gray-900">

  <!-- Header -->
  <header class="bg-green-600 text-white py-6">
    <div class="max-w-5xl mx-auto text-center">
      <h1 class="text-2xl md:text-3xl font-bold">ระบบสร้างไฟล์เสียงประกาศประชาสัมพันธ์</h1>
      <p class="text-sm md:text-base mt-1 tracking-wide">Public Relation Audio Announcement Management</p>
    </div>
  </header>

  <!-- Main Content -->
  <main class="max-w-5xl mx-auto mt-10 px-4">
    <h2 class="text-xl font-semibold border-b-2 border-orange-600 pb-2 mb-6 uppercase">PR Announcement</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Thai PR Message -->
      <div>
        <label class="block text-sm font-medium mb-2">ข้อความประกาศ ประชาสัมพันธ์</label>
        <textarea rows="6" class="w-full p-3 border border-gray-300 rounded resize-none" placeholder="กรุณาใส่ข้อความที่นี่">เสียงของคุณมีความหมายกับ MEA ร่วมตอบแบบสอบถาม รับ 100 MEA Point เฉพาะสมาชิก MEA Point ประเภทบ้านอยู่อาศัย ในพื้นที่กรุงเทพมหานคร นนทบุรี และสมุทรปราการ ร่วมกิจกรรมได้ถึง 31 ธันวาคม 2568 คลิกที่ event dot M E A dot th slash redeem สอบถามเพิ่มเติมที่ Facebook MEA หรือ LINE MEA Connect</textarea>

        <div class="mt-3 flex gap-2">
          <div class="flex items-center gap-2">
            <button onclick="rewindAudio('audio-th')" class="bg-gray-300 px-2 py-1 rounded hover:bg-gray-400">«</button>
            <button onclick="togglePlay('audio-th')" id="btn-audio-th" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">►</button>
            <button onclick="forwardAudio('audio-th')" class="bg-gray-300 px-2 py-1 rounded hover:bg-gray-400">»</button>
            <span id="time-audio-th" class="text-sm text-gray-700 ml-2">0:00</span>
          </div>
          <button class="bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400">แก้ไข</button>
        </div>
        <audio id="audio-th" src="MEA_PR_TH.mp3"></audio>
      </div>

      <!-- English PR Message -->
      <div>
        <label class="block text-sm font-medium mb-2">Public Relation message</label>
        <textarea rows="6" class="w-full p-3 border border-gray-300 rounded resize-none" placeholder="Please enter your message">Your voice matters to MEA. Complete a short survey and receive 100 MEA Points. Open to MEA Point members with residential accounts. Available in Bangkok, Nonthaburi, and Samut Prakan. Campaign runs until December 31st, 2025. Visit event dot M E A dot or dot th slash redeem. For more details, contact us via Facebook MEA or LINE MEA Connect.</textarea>

        <div class="mt-3 flex gap-2">
          <div class="flex items-center gap-2">
            <button onclick="rewindAudio('audio-en')" class="bg-gray-300 px-2 py-1 rounded hover:bg-gray-400">«</button>
            <button onclick="togglePlay('audio-en')" id="btn-audio-en" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">►</button>
            <button onclick="forwardAudio('audio-en')" class="bg-gray-300 px-2 py-1 rounded hover:bg-gray-400">»</button>
            <span id="time-audio-en" class="text-sm text-gray-700 ml-2">0:00</span>
          </div>
          <button class="bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400">Edit</button>
        </div>
        <audio id="audio-en" src="MEA_PR_EN.mp3"></audio>
      </div>
    </div>

    <!-- Footer Area -->
    <div class="mt-8">
      <label class="block mb-2 text-sm font-medium">วันเวลา สิ้นสุดสำหรับประกาศประชาสัมพันธ์</label>
      <div class="flex flex-col md:flex-row md:items-center gap-4">
        <input id="expired-datetime" type="datetime-local" class="border border-gray-300 p-2 rounded w-full md:w-1/3" value="2025-08-15T22:59" />
        <label class="flex items-center space-x-2 text-sm">
          <input id="no-expired-checkbox" type="checkbox" class="accent-red-600" />
          <span>ไม่มีวันหมดอายุ</span>
        </label>
        <button id="submit-button" onclick="showApprovalMessage()" class="bg-gray-400 text-white px-6 py-2 rounded cursor-not-allowed" disabled title="ท่านต้องทำการ กดฟังคำประกาศก่อนส่งขออนุมัติ">ส่งขออนุมัติ</button>
      </div>
    </div>
  </main>
</main>
<script>
  function togglePlay(id) {
    const audio = document.getElementById(id);
    const btn = document.getElementById('btn-' + id);
    if (audio.paused) {
      audio.play();
      btn.textContent = '❚❚';
    } else {
      audio.pause();
      btn.textContent = '►';
    }
  }

  function rewindAudio(id) {
    const audio = document.getElementById(id);
    audio.currentTime = Math.max(audio.currentTime - 5, 0);
  }

  function forwardAudio(id) {
    const audio = document.getElementById(id);
    audio.currentTime = Math.min(audio.currentTime + 5, audio.duration);
  }

  function formatTime(sec) {
    const m = Math.floor(sec / 60);
    const s = Math.floor(sec % 60);
    return `${m}:${s < 10 ? '0' : ''}${s}`;
  }

  function showApprovalMessage() {
    const checkbox = document.getElementById('no-expired-checkbox');
    const input = document.querySelector('input[type="datetime-local"]');
    if (checkbox.checked) {
      alert(`ระบบได้ทำการส่งคำขออนุมัติเสียงประกาศประชาสัมพันธ์แบบไม่กำหนดวันหมดอายุ`);
    } else {
      const dateTime = input ? input.value : '';
      alert(`ระบบได้ทำการส่งคำขออนุมัติเสียงประกาศประชาสัมพันธ์ โดยมีวันและเวลาสิ้นสุดถึง ${dateTime}`);
    }
  }

  let playedTh = false;
  let playedEn = false;

  function checkSubmitEnabled() {
    if (playedTh && playedEn) {
      const btn = document.getElementById('submit-button');
      btn.disabled = false;
      btn.classList.remove('bg-gray-400', 'cursor-not-allowed');
      btn.classList.add('bg-red-600', 'hover:bg-red-700');
    }
  }

  document.addEventListener('DOMContentLoaded', () => {
    const audio = document.getElementById('audio-th');
    const display = document.getElementById('time-audio-th');
    if (audio && display) {
      audio.addEventListener('timeupdate', () => {
        display.textContent = formatTime(audio.currentTime);
      });
      audio.addEventListener('play', () => {
        playedTh = true;
        checkSubmitEnabled();
      });
      audio.addEventListener('ended', () => {
        document.getElementById('btn-audio-th').textContent = '►';
      });
    }

    const audioEn = document.getElementById('audio-en');
    const displayEn = document.getElementById('time-audio-en');
    if (audioEn && displayEn) {
      audioEn.addEventListener('timeupdate', () => {
        displayEn.textContent = formatTime(audioEn.currentTime);
      });
      audioEn.addEventListener('play', () => {
        playedEn = true;
        checkSubmitEnabled();
      });
      audioEn.addEventListener('ended', () => {
        document.getElementById('btn-audio-en').textContent = '►';
      });
    }
    // Toggle enable/disable expiry datetime input based on checkbox
    document.getElementById('no-expired-checkbox').addEventListener('change', function () {
      const datetimeInput = document.getElementById('expired-datetime');
      if (this.checked) {
        datetimeInput.disabled = true;
        datetimeInput.value = '';
      } else {
        datetimeInput.disabled = false;
      }
    });
  });
</script>
</body>
</html>